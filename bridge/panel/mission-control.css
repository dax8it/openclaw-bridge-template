:root {
  --bg: #071021;
  --bg-soft: #0f1b31;
  --card: rgba(14, 27, 49, 0.82);
  --card-border: rgba(123, 157, 190, 0.25);
  --text: #e8f1ff;
  --muted: #96aac4;
  --ok: #39d98a;
  --warn: #f8b84e;
  --danger: #ff6f6f;
  --info: #6bc2ff;
  --accent: #17a2ff;
}
* { box-sizing: border-box; }
body {
  margin: 0;
  min-height: 100vh;
  font-family: "IBM Plex Mono", "SFMono-Regular", Menlo, Consolas, monospace;
  color: var(--text);
  background:
    radial-gradient(circle at 10% 0%, rgba(24, 111, 185, 0.22), transparent 40%),
    radial-gradient(circle at 90% 10%, rgba(25, 158, 121, 0.18), transparent 35%),
    linear-gradient(160deg, #050b16, #0b1930 45%, #0f213b);
}
.topbar {
  position: sticky;
  top: 0;
  z-index: 10;
  display: flex;
  gap: 12px;
  justify-content: space-between;
  align-items: center;
  padding: 14px 18px;
  border-bottom: 1px solid var(--card-border);
  backdrop-filter: blur(14px);
  background: rgba(7, 16, 33, 0.84);
}
.brand {
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.brand .title { font-size: 17px; font-weight: 700; letter-spacing: 0.02em; }
.brand .subtitle { color: var(--muted); font-size: 12px; }
.token-wrap {
  display: flex;
  align-items: center;
  gap: 8px;
  min-width: 280px;
}
.token-wrap input {
  width: 100%;
  border: 1px solid #335074;
  background: #060f20;
  color: var(--text);
  padding: 8px 10px;
  border-radius: 10px;
  font: inherit;
}
.page {
  padding: 16px;
  display: grid;
  gap: 14px;
}
.banner {
  display: none;
  border: 1px solid rgba(255, 183, 3, 0.35);
  background: rgba(83, 61, 0, 0.4);
  border-radius: 12px;
  padding: 12px;
  color: #ffdb8a;
}
.banner.error {
  display: block;
  border-color: rgba(255, 111, 111, 0.45);
  background: rgba(96, 26, 26, 0.35);
  color: #ffd0d0;
}
.banner.warn { display: block; }
.grid {
  display: grid;
  grid-template-columns: repeat(12, minmax(0, 1fr));
  gap: 12px;
  align-items: start;
}
.card {
  border: 1px solid var(--card-border);
  background: var(--card);
  border-radius: 14px;
  padding: 12px;
  align-self: start;
}
.card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 8px;
}
.card-header h2 {
  margin: 0;
}
.card-toggle {
  padding: 4px 8px;
  font-size: 11px;
  color: var(--muted);
  border-color: rgba(123, 157, 190, 0.45);
  background: rgba(9, 17, 33, 0.72);
}
.card[data-collapsed="1"] .card-body {
  display: none;
}
.card[data-collapsed="1"] {
  min-height: 0 !important;
}
.card h2 {
  margin: 0 0 10px;
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--muted);
}
.health { grid-column: span 12; }
.health { border-top: 3px solid rgba(57, 217, 138, 0.55); }
.health-grid {
  display: grid;
  grid-template-columns: repeat(5, minmax(0, 1fr));
  gap: 10px;
}
.metric {
  border: 1px solid rgba(123, 157, 190, 0.24);
  background: rgba(6, 14, 26, 0.7);
  border-radius: 10px;
  padding: 9px;
}
.metric .label { color: var(--muted); font-size: 11px; }
.metric .value { margin-top: 4px; font-size: 14px; font-weight: 700; }
.ok { color: var(--ok); }
.warn-text { color: var(--warn); }
.danger { color: var(--danger); }
.info { color: var(--info); }
.agents { grid-column: span 12; border-top: 3px solid rgba(91, 196, 255, 0.5); }
.agent-rail {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 10px;
}
.agent-card {
  border: 1px solid rgba(123, 157, 190, 0.24);
  border-radius: 11px;
  background: rgba(7, 16, 30, 0.7);
  padding: 10px;
  display: grid;
  grid-template-columns: 48px 1fr;
  gap: 10px;
}

.talk-btn {
  border: 1px solid rgba(123, 157, 190, 0.45);
  background: rgba(9, 17, 33, 0.72);
  color: rgba(255,255,255,0.80);
  border-radius: 10px;
  font: inherit;
  padding: 4px 8px;
  cursor: pointer;
  font-size: 11px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}
.talk-btn:hover {
  border-color: #53b3ff;
  background: rgba(23, 162, 255, 0.15);
}

.talk-dot {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 999px;
  margin-left: 8px;
  background: rgba(255,255,255,0.15);
  box-shadow: none;
}
.talk-dot.idle {
  background: rgba(255, 92, 92, 0.95);
  box-shadow: 0 0 0 2px rgba(255, 92, 92, 0.18);
}
.talk-state {
  font-size: 10px;
  color: rgba(255,255,255,0.86);
}
.talk-dot.listen,
.talk-dot.speak {
  background: rgba(57, 217, 138, 0.95);
  box-shadow: 0 0 0 2px rgba(57, 217, 138, 0.2);
}
.talk-dot.think {
  background: rgba(248, 184, 78, 0.95);
  box-shadow: 0 0 0 2px rgba(248, 184, 78, 0.2);
}

.agent-card.voice-state-idle {
  border-color: rgba(255, 92, 92, 0.38);
  box-shadow: inset 0 0 0 1px rgba(255, 92, 92, 0.12);
}
.agent-card.voice-state-listen,
.agent-card.voice-state-speak {
  border-color: rgba(57, 217, 138, 0.55);
  box-shadow: 0 0 22px rgba(57, 217, 138, 0.18), inset 0 0 0 1px rgba(57, 217, 138, 0.2);
}
.agent-card.voice-state-think {
  border-color: rgba(248, 184, 78, 0.55);
  box-shadow: 0 0 22px rgba(248, 184, 78, 0.18), inset 0 0 0 1px rgba(248, 184, 78, 0.2);
}
.avatar {
  width: 48px;
  height: 48px;
  border-radius: 9px;
  border: 1px solid rgba(145, 173, 203, 0.35);
  image-rendering: pixelated;
  background: #111b2e;
}
.agent-meta .name { font-weight: 700; font-size: 13px; }
.agent-meta .tiny { color: var(--muted); font-size: 11px; margin-top: 2px; }
.rail-line {
  margin-top: 6px;
  padding-top: 6px;
  border-top: 1px dashed rgba(123, 157, 190, 0.24);
  font-size: 11px;
  color: #d2e2f6;
}
.sessions { margin-top: 10px; display: grid; gap: 6px; }
.session-chip {
  font-size: 11px;
  border: 1px solid rgba(123, 157, 190, 0.22);
  border-radius: 8px;
  padding: 6px;
  background: rgba(8, 14, 27, 0.6);
}
.feed { grid-column: span 6; border-top: 3px solid rgba(91, 196, 255, 0.45); }
.feed[data-collapsed="0"] { min-height: 420px; }
.projects { grid-column: span 6; border-top: 3px solid rgba(248, 184, 78, 0.45); }
.missions { grid-column: span 6; border-top: 3px solid rgba(255, 111, 111, 0.45); }
.calendar { grid-column: span 6; border-top: 3px solid rgba(57, 217, 138, 0.45); }
.services { grid-column: span 6; border-top: 3px solid rgba(91, 196, 255, 0.45); }
.voice {
  border-top: 3px solid rgba(124, 58, 237, 0.55);
  min-width: 360px;
  position: fixed;
  right: 14px;
  bottom: 14px;
  width: min(460px, calc(100vw - 28px));
  max-height: 72vh;
  overflow: hidden;
  z-index: 1200;
  box-shadow: 0 14px 34px rgba(0,0,0,0.45);
}
.voice.is-collapsed .voice-controls,
.voice.is-collapsed .helper,
.voice.is-collapsed .controls,
.voice.is-collapsed .voice-chat,
.voice.is-collapsed .voice-settings,
.voice.is-collapsed audio,
.voice.is-collapsed pre { display: none; }
.voice-head { cursor: move; user-select: none; margin-bottom: 6px; }
.voice-global-state { font-size: 11px; margin-left: 8px; padding: 2px 7px; border-radius: 999px; border: 1px solid rgba(123,157,190,0.35); }
.voice-global-state.idle { color: #ff9d9d; border-color: rgba(255,92,92,0.45); }
.voice-global-state.listen { color: #8cffc1; border-color: rgba(57,217,138,0.45); }
.voice-global-state.think { color: #ffd58e; border-color: rgba(248,184,78,0.45); }
.voice-global-state.speak { color: #8bd3ff; border-color: rgba(91,196,255,0.45); }
.voice-global-state.muted { color: #ff9d9d; border-color: rgba(255,92,92,0.45); }
.voice-chat {
  border: 1px solid #355780;
  background: rgba(8,16,30,0.85);
  border-radius: 10px;
  min-height: 220px;
  max-height: 38vh;
  overflow: auto;
  padding: 10px;
  display: grid;
  gap: 8px;
}
.voice-msg { border: 1px solid rgba(123,157,190,0.28); border-radius: 12px; padding: 9px; max-width: 95%; }
.voice-msg.you { background: rgba(91,196,255,0.12); margin-left: auto; }
.voice-msg.assistant { background: rgba(57,217,138,0.10); margin-right: auto; }
.voice-msg.system { background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.8); font-size: 12px; text-align: center; margin: 0 auto; }
.voice-msg .meta { font-size: 11px; color: rgba(255,255,255,0.65); margin-bottom: 4px; }
.voice-msg .text { white-space: pre-wrap; line-height: 1.35; }
.voice-compose input { flex: 1 1 220px; min-width: 180px; }
.notes { grid-column: span 6; border-top: 3px solid rgba(255, 196, 107, 0.45); }
.actions { grid-column: span 6; border-top: 3px solid rgba(138, 170, 201, 0.45); }
.row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}
.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 8px;
}
button, select, input {
  border: 1px solid #355780;
  background: #0a172d;
  color: var(--text);
  border-radius: 8px;
  font: inherit;
  padding: 6px 9px;
  cursor: pointer;
}
textarea {
  width: 100%;
  border: 1px solid #355780;
  background: #0a172d;
  color: var(--text);
  border-radius: 8px;
  font: inherit;
  padding: 8px 9px;
  resize: vertical;
  min-height: 82px;
}
button.active {
  border-color: #53b3ff;
  background: rgba(23, 162, 255, 0.15);
}

/* Voice card tweaks */
.card.voice textarea { min-height: 72px; }
.card.voice .controls { gap: 8px; flex-wrap: wrap; }
.card.voice .inline { display: inline-flex; gap: 8px; align-items: center; color: rgba(255,255,255,0.75); font-size: 13px; }
.card.voice pre { margin: 10px 0 0; }
.voice-settings { border: 1px solid rgba(123,157,190,0.22); border-radius: 10px; padding: 8px; margin-bottom: 8px; background: rgba(7,16,30,0.55); }
.voice-settings.is-collapsed { display: none; }
.list {
  display: grid;
  gap: 7px;
  max-height: 340px;
  overflow: auto;
  padding-right: 3px;
}
.list-item {
  border: 1px solid rgba(123, 157, 190, 0.18);
  border-radius: 10px;
  padding: 8px;
  background: rgba(9, 17, 33, 0.65);
}
.list-item .title { font-size: 12px; font-weight: 700; }
.list-item .meta { color: var(--muted); font-size: 11px; margin-top: 4px; }
.list-item .next { margin-top: 6px; font-size: 11px; }
.feed-item { cursor: pointer; }
.feed-item.selected {
  border-color: rgba(107, 194, 255, 0.55);
  background: rgba(10, 28, 48, 0.85);
}
.feed-item .badge {
  font-size: 10px;
  display: inline-block;
  padding: 2px 5px;
  border-radius: 999px;
  border: 1px solid rgba(138, 170, 201, 0.35);
  margin-right: 6px;
}
pre {
  margin: 8px 0 0;
  white-space: pre-wrap;
  word-break: break-word;
  border: 1px solid rgba(123, 157, 190, 0.2);
  border-radius: 10px;
  background: rgba(3, 9, 18, 0.75);
  padding: 9px;
  max-height: 220px;
  overflow: auto;
  font-size: 11px;
}
.mission-cols {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 8px;
}
.col {
  border: 1px dashed rgba(123, 157, 190, 0.24);
  border-radius: 10px;
  padding: 7px;
  background: rgba(8, 14, 27, 0.5);
}
.col h3 {
  margin: 0 0 8px;
  color: var(--muted);
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.06em;
}
.actions-grid {
  display: grid;
  gap: 6px;
}
.action-btn { width: 100%; text-align: left; }
.services-list {
  display: grid;
  gap: 8px;
}
.service-row {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
  border: 1px solid rgba(123, 157, 190, 0.2);
  border-radius: 10px;
  padding: 8px;
  background: rgba(9, 17, 33, 0.65);
}
.service-controls {
  display: grid;
  gap: 6px;
  align-content: center;
}
.service-controls button {
  min-width: 84px;
}
.tiny-btn {
  padding: 4px 7px;
  font-size: 10px;
  min-height: 28px;
}
.helper {
  color: var(--muted);
  font-size: 11px;
  margin-top: 8px;
}
.empty {
  color: var(--muted);
  border: 1px dashed rgba(123, 157, 190, 0.3);
  border-radius: 10px;
  padding: 10px;
  font-size: 11px;
}
@media (max-width: 1100px) {
  .feed, .projects, .missions, .calendar, .services, .voice, .notes, .actions { grid-column: span 12; min-width: 0; }
  .health-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .mission-cols { grid-template-columns: 1fr; }
}
@media (max-width: 820px) {
  .topbar {
    flex-direction: column;
    align-items: stretch;
  }
  .token-wrap {
    min-width: 0;
    width: 100%;
  }
  button, select, textarea, input {
    min-height: 38px;
  }
}
@media (max-width: 560px) {
  .page {
    padding: 10px;
  }
  .card {
    padding: 10px;
    border-radius: 12px;
  }
  .brand .title {
    font-size: 15px;
  }
  .brand .subtitle {
    font-size: 11px;
  }
}
